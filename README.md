# EmoLyrics IAO Project - Group 6

**Authors:** Luc√≠a Bachiller, Vicente Barbato, Juan Mac√≠as

## Description

A deep learning-based system for emotional analysis of song lyrics. Includes an interactive Streamlit web application that analyzes lyrics and compares different versions to evaluate their emotional profile.

## üöÄ Quick Start

### 1. Environment Setup

**Option A: Create Conda environment (recommended)**
```bash
conda env create -f environment.yml
conda activate iao
```

**Option B: Install dependencies manually**
```bash
pip install streamlit altair pandas matplotlib torch sentence-transformers scikit-learn joblib numpy
```

### 2. Data Preparation

1. Download `spotify_dataset.csv` from [Kaggle](https://www.kaggle.com/datasets/devdope/900k-spotify/data) and place it in `data/`
2. Run the cleaning script:
   ```bash
   cd scripts
   python clean-emotion.py
   ```
   This generates `data/spotify_emotion_clean.csv`

### 3. Model Training

1. Open the Jupyter notebook:
   ```bash
   cd training
   jupyter notebook emotion-classification-lyrics.ipynb
   ```
2. Execute all cells to train the model (saved in `training/models/`)
3. (Optional) Test inference: `python test_inference.py`

### 4. Run Web Application

```bash
streamlit run app.py
```

The app will open at `http://localhost:8501` with two tabs:
- **Analyze your lyrics:** Analyze lyrics manually or upload a .txt file
- **Compare versions:** Compare different saved versions of lyrics

## üìÅ Project Structure

### Root
- `app.py` - Streamlit application entry point
- `emo_core.py` - Core business logic: emotion scoring, Altair charts, session state, HTML/CSS templates
- `environment.yml` - Conda environment configuration

### `data/`
- `spotify_dataset.csv` - Original dataset (500K+ songs) from [Kaggle](https://www.kaggle.com/datasets/devdope/900k-spotify/data)
- `spotify_emotion_clean.csv` - Cleaned dataset generated by `clean-emotion.py`

### `scripts/`
- `clean-emotion.py` - Dataset cleaning and preprocessing (normalization, filtering, visualization)
- `clean-good4.py` - Alternative cleaning for "Good for" labels
- `visualize-good4.py` - Visualization scripts for distributions

### `interface/`
- `ui.py` - UI module with main tabs
- `styles.css` - Custom Streamlit styling
- `templates.html` - Reusable HTML templates

### `training/`
- `emotion-classification-lyrics.ipynb` - Complete training pipeline
- `test_inference.py` - Model inference testing script
- `models/` - Trained PyTorch models and scaler

## üíª Dependencies

- **Python 3.9+**
- **streamlit >= 1.28.0** - Web framework
- **pandas >= 1.5.0** - Data manipulation
- **altair >= 5.0.0** - Interactive visualizations
- **torch >= 2.0.0** - Deep learning framework
- **sentence-transformers >= 2.2.0** - Text embeddings (all-MiniLM-L6-v2, all-MiniLM-L12-v2, all-distilroberta-v1, all-mpnet-base-v2)
- **scikit-learn >= 1.3.0** - Preprocessing and metrics
- **joblib >= 1.3.0** - Model serialization
- **numpy >= 1.24.0** - Numerical operations
- **matplotlib >= 3.7.0** - Visualizations

## üìù Important Notes

### Dataset
- The original `spotify_dataset.csv` must be downloaded from Kaggle (not included due to size)
- Place it in `data/` before running `clean-emotion.py`

### Models
- Models are created by running the training notebook
- Main model: `emotion_classifier_v2.pt`
- **Note:** `emo_core.py` currently uses random values as placeholder. To use the real model, integrate the loading logic from `test_inference.py`

### System Requirements
- Training requires 8GB+ RAM and may take several hours
- GPU (CUDA) recommended for faster embedding generation

### Detected Emotions
The model classifies 6 emotions: **Anger**, **Fear**, **Joy**, **Love**, **Sadness**, **Surprise**

### Configuration
- Scripts assume execution from project root or their respective directories
- Streamlit defaults to port 8501 (auto-increments if occupied)
- Works best in modern browsers (Chrome, Firefox, Safari, Edge)
